{"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"22eos54kli61"}},"id":"1rdwX8cvQ5gmoeUBlfMctt","type":"Entry","createdAt":"2019-12-04T21:49:00.470Z","updatedAt":"2019-12-05T08:45:52.632Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"revision":5,"contentType":{"sys":{"type":"Link","linkType":"ContentType","id":"post"}},"locale":"de"},"fields":{"slug":"2018-02-10-typo3-und-die-content-security-policy","headline":"TYPO3 und die Content Security Policy","description":"Was ist eigentlich die Content Security Policy und warum sollte ich sie einsetzen? Eine integration in TYPO3","image":{"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"22eos54kli61"}},"id":"60zPQjOL7WOR2dZH9hFIsH","type":"Asset","createdAt":"2019-12-04T21:55:13.101Z","updatedAt":"2019-12-04T21:55:13.101Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"revision":1,"locale":"de"},"fields":{"title":"2018-02-10-typo3-und-die-content-security-policy-full","file":{"url":"//images.ctfassets.net/22eos54kli61/60zPQjOL7WOR2dZH9hFIsH/e6ec7c3706fa4b22f9bc453a5d39e434/2018-02-10-typo3-und-die-content-security-policy-full.jpg","details":{"size":232130,"image":{"width":2560,"height":1440}},"fileName":"2018-02-10-typo3-und-die-content-security-policy-full.jpg","contentType":"image/jpeg"}}},"articleBody":"Wikipedia bescheib das Problem folgendermaßen:\n\nWebseiten können aktive Inhalte beispielsweise in Form von JavaScript-Code enthalten. Wenn die Webbrowser diesen Code ausführen, erzwingen sie die Einhaltung der Same-Origin-Policy. Dies bedeutet, dass Code von einer Quelle nicht auf Inhalte einer anderen Quelle zugreifen darf. So darf beispielsweise der Code in der Webseite eines Angreifers nicht auf die Elemente einer Onlinebanking-Webseite zugreifen.\n\nIn der Praxis sind jedoch Cross-Site-Scripting-Schwachstellen sehr verbreitet, wodurch die Same-Origin-Policy ausgehebelt wird. Eine Cross-Site-Scripting-Schwachstelle entsteht, wenn sich eine Webseite durch fehlerhafte Maskierung Code unterschieben lässt. Aus Sicht des Browsers kommt dieser untergeschobene Code aus der gleichen Quelle wie die angegriffene Webseite.\n\n\\##Die Lösung\n\nMittels Header Variable wird der Browser dazu veranlasst Scripte und Anweisungen im Quelltext zu Prüfen und gegebenenfalls nicht auszuführen.\n\nDies Bedeutet aber auch das viele Funktionen die eine Website benutzt wie z.b. Google Fonts oder Externe Bibliotheken oder CDN's in Ausnahmen definiert werden müssen. Um das Ganze zu vereinfachen gibt es die Webseite <https://www.cspisawesome.com/>. Diese ermöglicht uns für unsere Seite die Passende Content Security Policy zu generieren.\n\n## Einbindung\n\nAls erstes kommt uns natürlich in den Sinn das ganze über unseren Webserver einzubinden. Z.b. über den Apache (.htaccess)\n\n```\nHeader set Content-Security-Policy \"default-src 'none'\"\n```\n\nEs gibt dabei leider das Problem das es bei jedem Request eingebunden wird. Also auch bei jedem Bild oder aber auch im Backend. Was es danach leider unmöglich macht das Backend zu bedienen außer man gibt alles wieder Frei. Was ja auch nicht der Sinn der Sache ist.\n\nTypoScript: die bessere alternative\nTypoScript erlaubt uns das ganze sehr einfach zu erstellen. Hier können wir nämlich nur unsere TYPO3 Frontendausgabe mit der Content Security Policy versehen. Ohne das unser TYPO3 Backend oder die Assets beeinflusst werden.\n\n```\nconfig.additionalHeaders {\n    10.header = Content-Security-Policy: default-src 'none'\n}\n```\n\nSobald wir das ergänzt haben wird ab jetzt im Frontend immer dieser Header mit ausgegeben."}}